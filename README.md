# ObjectListView

## .NET DataView for objects


A DataView-like sorting and filtering view of a collection of arbitrary objects.  It is a full implementationof IBindingListView.  See the demo code and tests for examples of how to use it.  In general, just create yourlist, create an ObjectListView for that list, and use the ObjectListView as the DataSource for your Windows Formscontrol.  You'll need to reference ObjectListView.dll in your project.  The full class name is JesseJohnston.ObjectListView.Two versions are provided:
Class | Usage
----- | -----  ObjectListView | Works with any list item type.  List items are always referenced as type **object**.ObjectListView\<T> | Works with any list item type.  List items are always referenced as type T.The functionality of the two versions is identical.  The generic ObjectListView<T> offers slightly better performance and convenience(not having to cast back and forth from object to list item type).**Note:** ObjectListView/ObjectListView\<T> work with any list type that implements IList, and any list item type.  However, the best list type to use is BindingList\<T>, and your list item types should implement INotifyPropertyChanged.  If you don't use BindingList\<T> and/or your list items don't support INotifyPropertyChanged, ObjectListView won't update properly as list items change or when list items are added or removed from the underlying list.  If your underlying list and list items are unchanging, it doesn't matter what kind of list or list item types you have; ObjectListView will work just fine in that case.## LicenseObjectListView is free.  You are granted a perpetual, non-exclusive, royalty-free license to use the code in any commercial and non-commercialsoftware development works.  No attribution is required.  Jesse Johnston retains the copyright to ObjectListView and reserves all rights not explicitly granted in this license.## Building the source* The only external dependency is the NUnit testing framework (nunit.framework.dll).  You will need to fix up the NUnit DLL reference in the ObjectListView project before building.  If you don't want to build with NUnit, remove the NUnit reference and the folders within ObjectListView named Tests and TestsGeneric.* Tests are included in the same project as ObjectListView, for ease of testing internal methods.  However, the test code is automatically compiled out of the release build.  The build configurations containing the word "test" define the TEST pragma which includes all of the unit testing code.## DemosTwo example demos are provided.Demo.exe shows customer and order data from the Northwind database, illustrating data binding of ObjectListView to a ComboBox and a DataGridView.MasterDetailDemo.exe is a simple but real-world data entry form showing a master-detail view of customer data, with currency management through a BindingNavigator, editing in both the DataGridView and details controls, and multi-column sorting in the DataGridView.  This demo also illustrates saving and loading data and the use of BeginUpdate()/EndUpdate() for better view performance.### To run the demosMasterDetailDemo.exe requires no database or special configuration.  The following steps are for Demo.exe only, which requires the Northwind database.1. SQL Server 2000/2005/Express must be installed.2. Install the Microsoft sample Northwind database, which can be downloaded from:	[http://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46A0-8DA2-EEBC53A68034&displaylang=en][2]3. Edit the connection string in Demo.exe.config to reference your computer name in the data source (instead of "DADBOX").Note that SQL Server is not required for general use of ObjectListView.  This demo reads data from the Northwind database,and that's the only reason why SQL Server is involved.### Demo.exeThe form shows a ComboBox and a DataGridView, each bound to a separate ObjectListView.  The two ObjectListViews share a common list of Customer objects.Select a list type and a list item type to observe the behavior of the ObjectListView with those types.List item type | Description
-------------- | -----------Customer | A simple list item with no property change notification.CustomerNotifying | A list item that implements INotifyPropertyChanged.List type | Description
--------- | -----------ArrayList | An ArrayList of the selected list item type (Customer or CustomerNotifying)List\<T> | A generic list of the selected list item type (behaves identically to ArrayList).BindingList\<T> | A generic BindingList of the selected list item type.  BindingList provides a ListChanged event.Using CustomerNotifying and BindingList\<T> produces optimal results: both list changes (add/delete) and list itemchanges (changing column values) are reflected correctly in the DataGridView and the ComboBox.### MasterDetailDemo.exeThe form shows TextBoxes in the top half of the form, for editing an individual list item.  The New button adds a row (a new Customer object) to the DataGridView in the bottom half of the form.  Click on a grid row to change the current list item, or use the navigation controls in the BindingNavigator at the bottom of the form.  The data bindings for the TextBoxes cause the properties of the currentgrid row to be reflected in the TextBoxes.  Edits in the grid rows are reflected in the TextBoxes and vice versa.Click on the grid column headers to change the sort.  Clicking on a column that is already sorted will reverse the order of the sort. Holding down the shift key while clicking adds an additional column to the sort.  Holding down the control key while clicking removes the column from the sort.As the sort changes, the current grid row position is changed to keep the previously selected item current.The main menu options for "Program Sort" allow you to select different custom sorts for the Program column.  Changing one of these options changesthe IComparer used for the Customer.Program property by updating the entry in the PropertyComparers collection of IComparers.
The main menu option "Use New Row" allows you to switch between the new row in the DataGridView and the New button to add new rows to the grid.The main menu options for "Program Filter" allow you to specify a custom filter for the Program column.  Check any combination of Program values to includethem in the filter.  Uncheck values to remove them.  Check "Unfiltered" to remove the filter and display all items in the list.Use the File/Load and Save menu options to load/save the data displayed in the grid.  Some sample data is provided in the file customers.dat.Questions?  Comments?  Email me at <jesse@teamjohnston.net> or post a comment to my blog at [www.teamjohnston.net/blog][1].Cheers,  
Jesse Johnston  March 2007

[1]: http://www.teamjohnston.net/blog/
[2]: http://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46A0-8DA2-EEBC53A68034&displaylang=en